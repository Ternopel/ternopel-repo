<script src='/javascript/crud.js'></script>
<script src='/javascript/products.js'></script>
<section class="page-container clear-fix">
	{{#def.load('admin_menu.html')}}
	<section class="main-content">
		<input type='hidden' name='_csrf' value='{{=it.csrfToken}}'>
		<h1>Gestión de Productos</h1>
		<input type='text' name='search' placeholder='Ingrese búsqueda' value='{{=it.search}}'>
		<input type='button' id='addProduct' value='Agregar Producto' ></input>
		<br/>
		<table id='productsTable' summary='/admin/products'>
			<tr>
				<th><h4>Descripción</h4></th>
				<th><h4>Url</h4></th>
				<th><h4>Categoría</h4></th>
				<th><h4>Packaging</h4></th>
				<th><h4></h4></th>
				<th><h4></h4></th>
			</tr>
			{{~ it.products:product}}
			<tr name='{{=product.id}}'>
				<td name='description' style='width: 500px;'><span>{{=product.description}}</span></td>
				<td name='url' style='width: 500px;'><span>{{=product.url}}</span></td>
				<td name='category_id' style='width: 500px;'>
					<select>
						{{~ it.categories:category}}
							{{? category.id === product.category_id}}
								<option value="{{=category.id}}" selected="selected">{{=category.name}}</option>
							{{??}}
								<option value="{{=category.id}}">{{=category.name}}</option>
							{{?}}
						{{~}}
					</select> 				
				<td name='packaging_id' style='width: 500px;'>
					<select>
						{{~ it.packaging:packaging}}
							{{? packaging.id === product.packaging_id}}
								<option value="{{=packaging.id}}" selected="selected">{{=packaging.name}}</option>
							{{??}}
								<option value="{{=packaging.id}}">{{=packaging.name}}</option>
							{{?}}
						{{~}}
					</select> 				
				</td>
				<td name='show_format' style="width:290px;">
					{{? product.show_format === true}}
						<input type='checkbox' name='formatscheck1' checked='checked'>Ver formatos</input>
					{{??}}
						<input type='checkbox' name='formatscheck1'>Ver formatos</input>
					{{?}}
				</td>
				<td><input name='remove' type='button' value='Borrar'></input></td>
			</tr>
			{{? product.show_format === true}}
			<tr name='{{=product.id}}_format'>
			{{??}}
			<tr name='{{=product.id}}_format' style='display:none;'>
			{{?}}
				<td colspan="4">
					<br/>
					<input type='button' id='addProductFormat' name='{{=product.id}}' value='Agregar Formato' ></input>
					<br/>
					<table id='productsFormatsTable' summary='/admin/productsformats'>
						<tr>
							<th><h4>Formato</h4></th>
							<th><h4>Unidades</h4></th>
							<th><h4>Cantidad</h4></th>
							<th><h4>Precio Por Menor</h4></th>
							<th><h4>Precio Por Mayor</h4></th>
							<th><h4></h4></th>
						</tr>
						{{~ product.productsformats:productformat}}
						<tr name='{{=productformat.id}}'>
							<td name='format' style='width: 500px;'><span>{{=productformat.format}}</span></td>
							<td name='units' style='width: 500px;'><span>{{=productformat.units}}</span></td>
							<td name='quantity' style='width: 500px;'><span>{{=productformat.quantity}}</span></td>
							<td name='retail' style='width: 500px;'><span>{{=productformat.retail}}</span></td>
							<td name='wholesale' style='width: 500px;'><span>{{=productformat.wholesale}}</span></td>
							<td><input name='remove' type='button' value='Borrar'></input></td>
						</tr>
						{{~}}
					</table>
				</td>
			</tr>
			{{~}}
			
		</table>		
		
		
	</section>
</section>